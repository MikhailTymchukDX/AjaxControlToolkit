function callbackSuccessStub(e,t){var i=t.split(":"),r=i[0],a=$find(r);a&&a._onCallbackSuccess(e,i[1])}function callbackErrorStub(e,t){var i=t.split(":"),r=i[0],a=$find(r);alert("error"),a&&a._onCallbackError(e,i[1])}Type.registerNamespace("Sys.Extended.UI"),Sys.Extended.UI.RepeatDirection=function(){throw Error.invalidOperation()},Sys.Extended.UI.RepeatDirection.prototype={Vertical:0,Horizontal:1},Sys.Extended.UI.RepeatDirection.registerEnum("Sys.Extended.UI.RepeatDirection"),Sys.Extended.UI.DragDropList=function(e){Sys.Extended.UI.DragDropList.initializeBase(this,[e]),this._acceptedDataTypes=[],this._isDragging=null,this._dataType=null,this._dragMode=Sys.Extended.UI.DragMode.Move,this._dragVisual=null,this._direction=Sys.Extended.UI.RepeatDirection.Vertical,this._emptyTemplate=null,this._emptyTemplateInstance=null,this._dropCueTemplate=null,this._dropCueTemplateInstance=null,this._floatContainerInstance=null,this._originalParent=null,this._originalNextSibling=null,this._originalZIndex=null,this._currentContext=null,this._data=null},Sys.Extended.UI.DragDropList.IsValidDataType=function(e){return!!(e&&"string"==typeof e&&e.length>=4)&&"HTML"===e.substring(0,4)},Sys.Extended.UI.DragDropList.prototype={get_data:function(){return this._data},set_data:function(e){this._data=e},initialize:function(){Sys.Extended.UI.DragDropList.callBaseMethod(this,"initialize"),this.get_element().__dragDropList=this,Sys.Extended.UI.DragDropManager.registerDropTarget(this)},startDragDrop:function(e,t,i){this._isDragging||(this._isDragging=!0,this._currentContext=t,i?this._dragVisual=i:i=this.createDragVisual(e),Sys.Extended.UI.DragDropManager.startDragDrop(this,i,t,!(Sys.Browser.agent==Sys.Browser.InternetExplorer&&Sys.Browser.version>7&&0!=Sys.Browser.documentMode)))},createDragVisual:function(e){this._dragMode===Sys.Extended.UI.DragMode.Copy?this._dragVisual=e.cloneNode(!0):this._dragVisual=e;Sys.Extended.UI.DragDropManager._getInstance().getScrollOffset(e,!0);this._dragVisual.preDragWidth=this._dragVisual.style.width,this._dragVisual.preDragHeight=this._dragVisual.style.height,this._dragVisual.style.width=e.offsetWidth+"px",this._dragVisual.style.height=e.offsetHeight+"px",this._dragVisual.style.opacity="0.4",this._dragVisual.style.filter="progid:DXImageTransform.Microsoft.BasicImage(opacity=0.4);",this._originalZIndex=this._dragVisual.style.zIndex;var t=new Sys.Extended.UI.ZOrdering;this._dragVisual.style.zIndex=t.getTopZIndex(Sys.Extended.UI.zIndex.DropWatcherDragVisual),this._dragVisual.setAttribute(t.getOrderableElementAttributeName(),"dropWatcherDragVisual"),this._originalParent=this._dragVisual.parentNode,this._originalNextSibling=Sys.Extended.UI.DragDropManager._getInstance().getNextSibling(this._dragVisual);var i=$common.getLocation(e),r=this._getFloatContainer();return $common.setLocation(r,i),Sys.Extended.UI.DragDropManager._getInstance().hasParent(this._dragVisual)&&this._dragVisual.parentNode.removeChild(this._dragVisual),r.appendChild(this._dragVisual),r},get_emptyTemplate:function(){return this._emptyTemplate},set_emptyTemplate:function(e){this._emptyTemplate=e},get_dragDataType:function(){return this._dataType},set_dragDataType:function(e){this._dataType=e},getDragData:function(e){return e},get_dragMode:function(){return this._dragMode},set_dragMode:function(e){this._dragMode=e},dispose:function(){Sys.Extended.UI.DragDropManager.unregisterDropTarget(this),this.get_element().__dragDropList=null,Sys.Extended.UI.DragDropList.callBaseMethod(this,"dispose")},onDragStart:function(){this._validate()},onDrag:function(){},onDragEnd:function(e){if(this._floatContainerInstance?(this._dragMode===Sys.Extended.UI.DragMode.Copy?this._floatContainerInstance.removeChild(this._dragVisual):(this._dragVisual.style.opacity="0.999",this._dragVisual.style.filter="",this._dragVisual.style.zIndex=this._originalZIndex?this._originalZIndex:0,null!=this._dragVisual.preDragWidth&&(this._dragVisual.style.width=this._dragVisual.preDragWidth,this._dragVisual.preDragWidth=null),null!=this._dragVisual.preDragHeight&&(this._dragVisual.style.height=this._dragVisual.preDragHeight,this._dragVisual.preDragHeight=null),e?(this._dragVisual.parentNode.removeChild(this._dragVisual),null!=this._originalNextSibling?this._originalParent.insertBefore(this._dragVisual,this._originalNextSibling):this._originalParent.appendChild(this._dragVisual)):this._dragVisual.parentNode===this._floatContainerInstance&&this._dragVisual.parentNode.removeChild(this._dragVisual)),document.body.removeChild(this._floatContainerInstance)):this._dragVisual.parentNode.removeChild(this._dragVisual),!e&&this._data&&this._dragMode===Sys.Extended.UI.DragMode.Move){var t=this.getDragData(this._currentContext);this._data&&t&&Array.remove(this._data,t)}this._isDragging=!1,this._validate()},get_direction:function(){return this._direction},set_direction:function(e){this._direction=e},get_acceptedDataTypes:function(){return this._acceptedDataTypes},set_acceptedDataTypes:function(e){"string"==typeof e?this._acceptedDataTypes=e.split(","):this._acceptedDataTypes=e},get_dropCueTemplate:function(){return this._dropCueTemplate},set_dropCueTemplate:function(e){this._dropCueTemplate=e},get_dropTargetElement:function(){return this.get_element()},canDrop:function(e,t,i){for(var r=0;r<this._acceptedDataTypes.length;r++)if(this._acceptedDataTypes[r]===t)return!0;return!1},drop:function(e,t,i){if(Sys.Extended.UI.DragDropList.IsValidDataType(t)&&e===Sys.Extended.UI.DragMode.Move){dragVisual=i;var r=this._findPotentialNextSibling(dragVisual);this._setDropCueVisible(!1,dragVisual),dragVisual.parentNode.removeChild(dragVisual),r?this.get_element().insertBefore(dragVisual,r):this.get_element().appendChild(dragVisual)}else this._setDropCueVisible(!1)},onDragEnterTarget:function(e,t,i){Sys.Extended.UI.DragDropList.IsValidDataType(t)&&(this._setDropCueVisible(!0,i),this._validate())},onDragLeaveTarget:function(e,t,i){Sys.Extended.UI.DragDropList.IsValidDataType(t)&&(this._setDropCueVisible(!1),this._validate())},onDragInTarget:function(e,t,i){Sys.Extended.UI.DragDropList.IsValidDataType(t)&&this._setDropCueVisible(!0,i)},_setDropCueVisible:function(e,t){if(this._dropCueTemplate)if(e){if(!this._dropCueTemplateInstance){document.createDocumentFragment();this._dropCueTemplateInstance=this._dropCueTemplate.cloneNode(!0)}var i=this._findPotentialNextSibling(t);Sys.Extended.UI.DragDropManager._getInstance().hasParent(this._dropCueTemplateInstance)?Sys.Extended.UI.DragDropManager._getInstance().getNextSibling(this._dropCueTemplateInstance)!==i&&(this.get_element().removeChild(this._dropCueTemplateInstance),i?this.get_element().insertBefore(this._dropCueTemplateInstance,i):this.get_element().appendChild(this._dropCueTemplateInstance)):(i?this.get_element().insertBefore(this._dropCueTemplateInstance,i):this.get_element().appendChild(this._dropCueTemplateInstance),this._dropCueTemplateInstance.style.width=t.offsetWidth+"px",this._dropCueTemplateInstance.style.height=t.offsetHeight+"px")}else this._dropCueTemplateInstance&&Sys.Extended.UI.DragDropManager._getInstance().hasParent(this._dropCueTemplateInstance)&&this.get_element().removeChild(this._dropCueTemplateInstance)},_findPotentialNextSibling:function(e){for(var t,i=$common.getBounds(e),r=0===this._direction,a=this.get_element().firstChild;null!==a;a=a.nextSibling)if(a.innerHTML&&a!==this._dropCueTemplateInstance&&a!==this._emptyTemplateInstance&&(t=$common.getBounds(a),!r&&i.x<=t.x||r&&i.y<=t.y))return a;return null},_validate:function(){for(var e=null==this._dropCueTemplateInstance||!Sys.Extended.UI.DragDropManager._getInstance().hasParent(this._dropCueTemplateInstance),t=0,i=this.get_element().firstChild;null!==i;i=i.nextSibling)i.innerHTML&&i!==this._emptyTemplateInstance&&i!==this._dropCueTemplateInstance&&t++;t>0&&(e=!1),this._setEmptyTemplateVisible(e)},_setEmptyTemplateVisible:function(e){this._emptyTemplate&&(e?this._emptyTemplateInstance?Sys.Extended.UI.DragDropManager._getInstance().hasParent(this._emptyTemplateInstance)||this.get_element().appendChild(this._emptyTemplateInstance):this._emptyTemplateInstance=this._emptyTemplate.createInstance(this.get_element()).instanceElement:this._emptyTemplateInstance&&Sys.Extended.UI.DragDropManager._getInstance().hasParent(this._emptyTemplateInstance)&&this.get_element().removeChild(this._emptyTemplateInstance))},_getFloatContainer:function(){if(this._floatContainerInstance)Sys.Extended.UI.DragDropManager._getInstance().hasParent(this._floatContainerInstance)||document.body.appendChild(this._floatContainerInstance);else{this._floatContainerInstance=document.createElement(this.get_element().tagName);var e="0px 0px 0px 0px";this._floatContainerInstance.style.position="absolute",this._floatContainerInstance.style.padding=e,this._floatContainerInstance.style.margin=e,this._floatContainerInstance.className="dragVisualContainer",document.body.appendChild(this._floatContainerInstance)}return this._floatContainerInstance}},Sys.Extended.UI.DragDropList.registerClass("Sys.Extended.UI.DragDropList",Sys.Extended.UI.BehaviorBase,Sys.Extended.UI.IDragSource,Sys.Extended.UI.IDropTarget,Sys.IDisposable),Sys.Extended.UI.DragDropWatcher=function(e){Sys.Extended.UI.DragDropWatcher.initializeBase(this,[e]),this._childList=new Array,this._inProgressDrops=new Object,this._postbackCode=null,this._callbackCssStyle=null,this._argReplaceString=null,this._argContextString=null,this._argErrorString=null,this._argSuccessString=null},Sys.Extended.UI.DragDropWatcher.prototype={dispose:function(){Sys.Extended.UI.DragDropWatcher.callBaseMethod(this,"dispose")},initialize:function(){Sys.Extended.UI.DragDropWatcher.callBaseMethod(this,"initialize"),this._saveChildOrder()},add_reorderComplete:function(e){this.get_events().addHandler("reorderComplete",e)},remove_reorderComplete:function(e){this.get_events().removeHandler("reorderComplete",e)},raiseReorderComplete:function(){var e=this.get_events().getHandler("reorderComplete");e&&e(this,Sys.EventArgs.Empty)},findChild:function(e,t){for(var i=0,r=e.childNodes,a=0;a<r.length;a++){var s=r[a];if(null!=s&&"LI"==s.nodeName){if(s.id==t)return i;i++}}return-1},canDrop:function(e,t,i){if(this._inProgressDrops&&this._inProgressDrops.length>0)return!1;var r=Sys.Extended.UI.DragDropWatcher.callBaseMethod(this,"canDrop",[e,t,i]);if(r){for(var a,s=$common.getBounds(i),n=!1,o=this.get_element(),l=o.firstChild;null!=l&&!n;l=l.nextSibling)if(l.id){if(a=$common.getBounds(l),s.y<=a.y)break;n=l.id.lastIndexOf("Insert",l.id.length-6)!=-1}r=!n}return r},drop:function(e,t,i){Sys.Extended.UI.DragDropWatcher.callBaseMethod(this,"drop",[e,t,i]);var r=i.id;if(this._postbackCode&&r){var a=this.findChild(this.get_element(),r);Sys.Debug.assert(a!=-1,String.format(Sys.Extended.UI.Resources.ReorderList_DropWatcherBehavior_NoChild,r));var s=this._getSavedChildIndex(r);a!=-1&&a!=s&&(this._saveChildOrder(),this.doPostBack(r,a,s))}},_setupDropState:function(e,t,i){if(e){var r=$get(e);this._inProgressDrops[e]={oldCss:r.className,newIndex:t,oldIndex:i},this._callbackCssStyle&&(r.className=this._callbackCssStyle)}},_onDropCallback:function(e){if(e){this.set_ClientState("true");var t=this._inProgressDrops[e];if(t){var i=$get(e);this._callbackCssStyle&&(i.className=t.oldCss),delete this._inProgressDrops[e]}return t}},doPostBack:function(e,t,i){var r=this._inProgressDrops[e];if(!r){var a="reorder:"+e+":"+i.toString()+":"+t.toString(),s=this._postbackCode.replace(this._argReplaceString,a);this._argSuccessString&&(s=s.replace(this._argSuccessString,"callbackSuccessStub")),this._argErrorString&&(s=s.replace(this._argErrorString,"callbackErrorStub")),this._argContextString&&(s=s.replace(this._argContextString,this.get_id()+":"+e)),this._setupDropState(e,t,i),window.setTimeout(s,0)}},_onCallbackSuccess:function(e,t){e&&e.length>0?this._onCallbackError(e,t):(this._onDropCallback(t),this.raiseReorderComplete())},_onCallbackError:function(e,t){var i=this._onDropCallback(t);(i.oldIndex||i.newIndex)&&(this._saveChildOrder(),this.doReorder(i.newIndex,i.oldIndex,!0)),alert(String.format(Sys.Extended.UI.Resources.ReorderList_DropWatcherBehavior_CallbackError,e))},doReorder:function(e,t,i){var r=this.get_element(),a=this._childList;if(e>=0&&a.length>e&&e!=t){var s=$get(a[e]),n=this._inProgressDrops[s.id];if(n)return;if(s){t>e&&t++;var o=t>=a.length;try{r.removeChild(s)}catch(e){}if(o)r.appendChild(s);else{var l=$get(a[t]);r.insertBefore(s,l)}i?(this._saveChildOrder(),this.raiseReorderComplete()):this.doPostBack(s.id,t,e)}}},getItem:function(e){return this._childList||this._saveChildOrder(),this._childList[e]},_getSavedChildIndex:function(e){if(this._childList&&e)for(var t=0;t<this._childList.length;t++)if(e==this._childList[t])return t;return-1},_saveChildOrder:function(){var e=this.get_element();if(e){var t=e.childNodes;this._childList=[];for(var i=0,r=0;r<t.length;r++)t[r]&&t[r].parentNode===e&&t[r].tagName&&"li"==t[r].tagName.toLowerCase()&&(this._childList[i++]=t[r].id)}},get_argReplaceString:function(){return this._argReplaceString},set_argReplaceString:function(e){this._argReplaceString!=e&&(this._argReplaceString=e,this.raisePropertyChanged("argReplaceString"))},get_argContextString:function(){return this._argContextString},set_argContextString:function(e){this._argContextString!=e&&(this._argContextString=e,this.raisePropertyChanged("argContextString"))},get_argErrorString:function(){return this._argErrorString},set_argErrorString:function(e){this._argErrorString!=e&&(this._argErrorString=e,this.raisePropertyChanged("argErrorString"))},get_argSuccessString:function(){return this._argSuccessString},set_argSuccessString:function(e){this._argSuccessString!=e&&(this._argSuccessString=e,this.raisePropertyChanged("argSuccessString"))},get_postbackCode:function(){return this._postbackCode},set_postbackCode:function(e){this._postbackCode!=e&&(this._postbackCode=e,this.raisePropertyChanged("postbackCode"))},get_callbackCssStyle:function(){return this._callbackCssStyle},set_callbackCssStyle:function(e){this._callbackCssStyle!=e&&(this._callbackCssStyle=e,this.raisePropertyChanged("callbackCssStyle"))}},Sys.Extended.UI.DragDropWatcher.registerClass("Sys.Extended.UI.DragDropWatcher",Sys.Extended.UI.DragDropList);